<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="title" content="Happy Birthday Website 2.0 | Aoudumber Bade">
    <title>Ritika's Birthday</title>

    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@500;700&family=Poppins:wght@400;600&display=swap"
        rel="stylesheet">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" crossorigin="anonymous"></script>
</head>

<body>
    <div id="wrapper">
        <div class="flag__birthday">
            <img src="./images/1.png" alt="" width="350" class="flag__left">
            <img src="./images/1.png" alt="" width="350" class="flag__right">
        </div>

        <div class="content">
            <div class="left">
                <div class="title">
                    <h1 class="happy">
                        <span style="--t: 4s;">H</span>
                        <span style="--t: 4.2s;">a</span>
                        <span style="--t: 4.4s;">p</span>
                        <span style="--t: 4.6s;">p</span>
                        <span style="--t: 4.8s;">y</span>
                    </h1>
                    <h1 class="birthday">
                        <span style="--t: 5s;">B</span>
                        <span style="--t: 5.2s;">i</span>
                        <span style="--t: 5.4s;">r</span>
                        <span style="--t: 5.6s;">t</span>
                        <span style="--t: 5.8s;">h</span>
                        <span style="--t: 6s;">d</span>
                        <span style="--t: 6.2s;">a</span>
                        <span style="--t: 6.4s;">y</span>
                    </h1>
                    <div class="hat">
                        <img src="./images/hat.png" alt="" width="130">
                    </div>
                </div>

                <div class="date__of__birth">
                    <span></span>
                </div>

                <div class="btn">
                    <button id="btn__letter">
                        <div class="mail">
                            Your Love Letter
                            <i class="fa-regular fa-envelope"></i>
                        </div>
                    </button>
                </div>

                <!-- small lock popup (above button) -->
                <div class="miniLockPopup" id="miniLockPopup">
                    <div class="miniLockBox">
                        <h3 class="miniTitle">ðŸ”’ Locked</h3>
                        <p class="miniMsg">Solve a quiz to unlock your love letter.</p>
                        <div class="miniBtns">
                            <button id="miniContinue">Continue</button>
                            <button id="miniExit">Goodbye</button>
                        </div>
                    </div>
                </div>

            </div>

            <div class="right">
                <div class="box__account">
                    <div class="image">
                        <img src="./images/unnamed.png" alt="">
                    </div>
                    <div class="name">
                        <i class="fa-solid fa-heart"></i>
                        <span>Dear Pavitra</span>
                        <i class="fa-solid fa-heart"></i>
                    </div>
                    <div class="balloon_one">
                        <img width="100px" src="./images/balloon1.png" alt="">
                    </div>
                    <div class="balloon_two">
                        <img width="100px" src="./images/balloon2.png" alt="">
                    </div>
                </div>

                <div class="cricle">
                    <div class="text__cricle">
                        <span style="--i: 1;">h</span>
                        <span style="--i: 2;">a</span>
                        <span style="--i: 3;">p</span>
                        <span style="--i: 4;">p</span>
                        <span style="--i: 5;">y</span>
                        <span style="--i: 6;">-</span>
                        <span style="--i: 7;">b</span>
                        <span style="--i: 8;">i</span>
                        <span style="--i: 9;">r</span>
                        <span style="--i: 10;">t</span>
                        <span style="--i: 11;">h</span>
                        <span style="--i: 12;">d</span>
                        <span style="--i: 13;">a</span>
                        <span style="--i: 14;">y</span>
                        <span style="--i: 15;">-</span>
                    </div>
                    <i class="fa-solid fa-heart"></i>
                </div>
            </div>
        </div>

        <div class="decorate_star star1" style="--t: 15s;"></div>
        <div class="decorate_star star2" style="--t: 15.2s;"></div>
        <div class="decorate_star star3" style="--t: 15.4s;"></div>
        <div class="decorate_star star4" style="--t: 15.6s;"></div>
        <div class="decorate_star star5" style="--t: 15.8s;"></div>

        <div class="decorate_flower--one" style="--t: 15s;">
            <img width="20" src="./images/decorate_flower.png" alt="">
        </div>
        <div class="decorate_flower--two" style="--t: 15.3s;">
            <img width="20" src="./images/decorate_flower.png" alt="">
        </div>
        <div class="decorate_flower--three" style="--t: 15.6s;">
            <img width="20" src="./images/decorate_flower.png" alt="">
        </div>

        <div class="decorate_bottom">
            <img src="./images/decorate.png" alt="" width="100">
        </div>

        <div class="smiley__icon">
            <img src="./images/smiley_icon.png" alt="" width="100">
        </div>

        <!-- existing full-screen love-letter popup (boxMail) kept intact -->
        <div class="boxMail">
            <i class="fa-solid fa-xmark"></i>
            <div class="boxMail-container">
                <div class="card1">
                    <div class="userImg">
                        <img src="images/unnamed.png" alt="">
                    </div>
                    <h4 class="username">To: Pavitra ðŸ’–<span class="underline"></span></h4>
                    <h3>Happy Birthday</h3>
                    <div class="imageCute">
                        <img src="cute1.png" alt="">
                    </div>
                </div>
                <div class="card2">
                    <div class="card2-content">
                        <h3>To You!</h3>
                        <h2 id="finalLetterText">Happy birthday ðŸ¥³ðŸŽ‚ðŸ¥³ ...</h2>
                        <div class="imageCute2">
                            <img src="cute2.png" alt="">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- EXPERIENCE OVERLAY: PHOTO INTRO -> QUIZ -> PHOTO -> CAKE -> FIREWORKS -->
        <div class="experienceOverlay" id="experienceOverlay">
            <!-- PHOTO INTRO -->
            <div class="experienceScreen experienceScreen--photoIntro">
                <div class="experienceCard experienceCard--transparent">
                    <img src="./images/q1-bg.jpg" alt="intro" class="experiencePhotoIntro" id="introPhoto">
                    <p class="experienceSubtitle">Tap continue to start your surprise...</p>
                    <button id="photoIntroNext" class="quizSubmit">Continue</button>
                </div>
            </div>

            <!-- QUIZ (one-by-one) -->
            <div class="experienceScreen experienceScreen--quiz">
                <div class="quizContainer">
                    <div class="quizBg" id="quizBg"></div>

                    <div class="quizCard">
                        <h2 id="quizQuestion" class="quizTitle"></h2>

                        <div id="quizOptions" class="quizOptionsOneByOne"></div>

                        <button id="quizNextBtn" class="quizSubmit" style="display:none;">Next</button>
                    </div>
                </div>
            </div>

            <!-- GOODBYE -->
            <div class="goodbyePopup" id="goodbyePopup">
                <div class="goodbyeBox">
                    <p>Looks like you forgot something important ðŸ¥º<br>Goodbye!</p>
                    <button id="goodbyeCloseBtn">Okay</button>
                </div>
            </div>

            <!-- ONE MORE PHOTO -->
            <div class="experienceScreen experienceScreen--photo">
                <div class="experienceCard">
                    <img src="./images/q5-bg.jpg" alt="Photo" class="experiencePhoto" id="surprisePhoto">
                    <p class="experienceSubtitle">One more surprise for you...</p>
                    <button id="photoNextBtn" class="quizSubmit">Next</button>
                </div>
            </div>

            <!-- CAKE -->
            <div class="experienceScreen experienceScreen--cake">
                <div class="experienceCard">
                    <div class="digitalCake">
                        <div class="cake-base"></div>
                        <div class="cake-layer cake-layer--top"></div>
                        <div class="cake-layer cake-layer--middle"></div>
                        <div class="cake-layer cake-layer--bottom"></div>

                        <div class="cake-candles">
                            <div class="candle"><div class="flame"></div></div>
                            <div class="candle"><div class="flame"></div></div>
                            <div class="candle"><div class="flame"></div></div>
                        </div>
                    </div>
                    <button id="blowCandlesBtn" class="quizSubmit">Blow candles ðŸŽ‚</button>
                </div>
            </div>

            <!-- FIREWORKS -->
            <div class="experienceScreen experienceScreen--fireworks">
                <div class="experienceCard experienceCard--transparent">
                    <div class="fireworksContainer" id="fireworksContainer">
                        <div class="firework f1"></div>
                        <div class="firework f2"></div>
                        <div class="firework f3"></div>
                    </div>
                    <h2 class="fireworksMessage">Wishing You A Beautiful Year Ahead</h2>
                    <p class="fireworksSub">Happy Birthday Pavitra ðŸŽ‰</p>

                    <button id="unlockSurpriseBtn" class="quizSubmit">Unlock Your Surprise</button>
                </div>
            </div>

        </div>
        <!-- END EXPERIENCE OVERLAY -->

    </div>

    <!-- SCRIPTS: all behavior in single block -->
    <script>
        /***** Basic typing for date (unchanged) *****/
        let datetxt = "20th December";
        let charArrDate = datetxt.split('');
        let currentIndex = 0;
        let dateSpan = document.querySelector(".date__of__birth span");

        setTimeout(function () {
            let timeDatetxt = setInterval(function () {
                if (currentIndex < charArrDate.length) {
                    dateSpan.textContent += charArrDate[currentIndex];
                    currentIndex++;
                } else {
                    let i = document.createElement("i");
                    i.className = "fa-solid fa-star";
                    document.querySelector(".date__of__birth").prepend(i);
                    document.querySelector(".date__of__birth").appendChild(i.cloneNode(true));
                    clearInterval(timeDatetxt);
                }
            }, 100);
        }, 12000);

        /***** Audio (optional) *****/
        function loadAudio(path) {
            try {
                const a = new Audio(path);
                a.volume = 0.65;
                return a;
            } catch (e) {
                return null;
            }
        }
        const audioPop = loadAudio('./audio/pop.mp3');
        const audioWhoosh = loadAudio('./audio/whoosh.mp3');
        const audioBlow = loadAudio('./audio/blow.mp3');
        const audioFireworks = loadAudio('./audio/fireworks.mp3');

        /***** Quiz data (your answers) *****/
        const quizData = [
            { question: "What is Pavitraâ€™s nickname?", options: ["Chanda", "Babu", "Shona"], correct: "Chanda", bg: "./images/q1-bg.jpg" },
            { question: "What makes you smile the most?", options: ["Cake", "Messages", "Music"], correct: "Messages", bg: "./images/q2-bg.jpg" },
            { question: "What is my favorite thing about you?", options: ["Smile", "Hair", "Eyes"], correct: "Smile", bg: "./images/q3-bg.jpg" },
            { question: "Your dream place?", options: ["Goa", "Manali", "Paris"], correct: "Manali", bg: "./images/q4-bg.jpg" },
            { question: "What do you love the most?", options: ["Family", "Friends", "Me"], correct: "Family", bg: "./images/q5-bg.jpg" }
        ];

        // state
        let currentQuiz = 0;
        let selectedAnswer = null;

        // elements
        const btnLetter = document.getElementById('btn__letter');
        const miniLockPopup = document.getElementById('miniLockPopup');
        const miniContinue = document.getElementById('miniContinue');
        const miniExit = document.getElementById('miniExit');

        const experienceOverlay = document.getElementById('experienceOverlay');

        const quizScreen = document.querySelector('.experienceScreen--quiz');
        const quizQuestionEl = document.getElementById('quizQuestion');
        const quizOptionsEl = document.getElementById('quizOptions');
        const quizBgEl = document.getElementById('quizBg');
        const quizNextBtn = document.getElementById('quizNextBtn');

        const goodbyePopup = document.getElementById('goodbyePopup');
        const goodbyeCloseBtn = document.getElementById('goodbyeCloseBtn');

        const photoIntroNext = document.getElementById('photoIntroNext');
        const photoNextBtn = document.getElementById('photoNextBtn');

        const blowCandlesBtn = document.getElementById('blowCandlesBtn');
        const unlockSurpriseBtn = document.getElementById('unlockSurpriseBtn');

        const boxmail = document.querySelector('.boxMail');
        const boxmailClose = document.querySelector('.boxMail .fa-xmark');

        // helper: show overlay and a certain step
        function setExperienceStep(step) {
            // show overlay
            experienceOverlay.classList.add('experienceOverlay--active');

            // hide all screens
            document.querySelectorAll('.experienceScreen').forEach(s => {
                s.style.display = 'none';
            });

            // show requested
            const el = document.querySelector('.experienceScreen--' + step);
            if (el) el.style.display = 'flex';

            // play small pop sound
            if (audioPop) audioPop.currentTime = 0, audioPop.play();
        }

        // position mini popup above the button and show
        function showMiniPopup() {
            // find button rect relative to viewport
            const rect = btnLetter.getBoundingClientRect();

            // place miniLockPopup relative to document: put it inside .left so absolute works with that container
            // we used CSS absolute placed in DOM under .left so it will be above the button naturally
            miniLockPopup.style.display = 'block';
            // small whoosh
            if (audioWhoosh) { audioWhoosh.currentTime = 0; audioWhoosh.play(); }
        }

        // hide mini popup
        function hideMiniPopup() {
            miniLockPopup.style.display = 'none';
        }

        // initial event: clicking the "Your Love Letter" button
        btnLetter.addEventListener('click', function () {
            showMiniPopup();
        });

        miniExit.addEventListener('click', function () {
            hideMiniPopup();
        });

        // Continue â†’ open photo intro first
        miniContinue.addEventListener('click', function () {
            hideMiniPopup();
            setExperienceStep('photoIntro');
        });

        // PHOTO INTRO â†’ when user presses continue, blur photo into background and open quiz
        photoIntroNext.addEventListener('click', function () {
            // set overlay background to blurred photo (option A)
            const introPhoto = document.getElementById('introPhoto');
            const photoUrl = introPhoto ? introPhoto.src : null;
            if (photoUrl) {
                experienceOverlay.style.backgroundImage = `linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.85)), url(${photoUrl})`;
                experienceOverlay.style.backgroundSize = 'cover';
                experienceOverlay.style.backdropFilter = 'blur(4px)';
            }
            // go to quiz
            setExperienceStep('quiz');
            loadQuiz();
            if (audioWhoosh) audioWhoosh.currentTime = 0, audioWhoosh.play();
        });

        // build quiz screen one-by-one
        function loadQuiz() {
            const q = quizData[currentQuiz];
            if (!q) return;
            // background for quiz (blurred)
            quizBgEl.style.backgroundImage = `url('${q.bg}')`;
            // set question
            quizQuestionEl.textContent = q.question;

            // clear options
            quizOptionsEl.innerHTML = '';
            quizNextBtn.style.display = 'none';
            selectedAnswer = null;

            // add options (radio)
            q.options.forEach(opt => {
                const label = document.createElement('label');
                label.innerHTML = `<input type="radio" name="quizOpt" value="${opt}"> ${opt}`;
                quizOptionsEl.appendChild(label);
            });

            // attach events
            quizOptionsEl.querySelectorAll('input').forEach(input => {
                input.addEventListener('change', function () {
                    selectedAnswer = this.value;
                    quizNextBtn.style.display = 'block';
                    // soft select pop
                    if (audioPop) audioPop.currentTime = 0, audioPop.play();
                });
            });
        }

        // Next button (checks correctness)
        quizNextBtn.addEventListener('click', function () {
            const correct = quizData[currentQuiz].correct;
            if (selectedAnswer !== correct) {
                // wrong â†’ goodbye popup
                goodbyePopup.style.display = 'flex';
                if (audioPop) audioPop.currentTime = 0, audioPop.play();
                return;
            }

            // correct â†’ move on
            currentQuiz++;
            if (currentQuiz >= quizData.length) {
                // finished quiz â†’ show photo surprise
                setExperienceStep('photo');
                if (audioWhoosh) audioWhoosh.currentTime = 0, audioWhoosh.play();
            } else {
                loadQuiz();
            }
        });

        // close goodbye
        goodbyeCloseBtn.addEventListener('click', function () {
            goodbyePopup.style.display = 'none';
            // hide entire overlay and stop
            experienceOverlay.classList.remove('experienceOverlay--active');
            // reset quiz state
            currentQuiz = 0;
        });

        // after photo surprise next
        photoNextBtn.addEventListener('click', function () {
            setExperienceStep('cake');
            if (audioWhoosh) audioWhoosh.currentTime = 0, audioWhoosh.play();
        });

        // blow candles â†’ show fireworks
        blowCandlesBtn.addEventListener('click', function () {
            // animate candle blow: hide flames (CSS toggles)
            document.querySelector('.experienceScreen--cake .experienceCard').classList.add('cake--blown');
            if (audioBlow) { audioBlow.currentTime = 0; audioBlow.play(); }
            setTimeout(function () {
                setExperienceStep('fireworks');
                if (audioFireworks) { audioFireworks.currentTime = 0; audioFireworks.play(); }
            }, 900);
        });

        // unlock surprise â†’ open original full-screen love-letter boxMail
        unlockSurpriseBtn.addEventListener('click', function () {
            experienceOverlay.classList.remove('experienceOverlay--active');
            // open .boxMail like original
            if (boxmail) boxmail.classList.add('active');
        });

        // boxMail close existing
        if (boxmailClose && boxmail) {
            boxmailClose.addEventListener('click', function () {
                boxmail.classList.remove('active');
            });
        }

        // ensure overlay hides on start
        document.addEventListener('DOMContentLoaded', function () {
            document.querySelectorAll('.experienceScreen').forEach(s => s.style.display = 'none');
            miniLockPopup.style.display = 'none';
            goodbyePopup.style.display = 'none';
        });
    </script>
</body>

</html>
